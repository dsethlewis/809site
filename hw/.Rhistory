install.packages("corrr")
install.packages("wrapr")
install.packages('rmarkdown')
install.packages("rmarkdown")
install.packages('knitr')
install.packages("knitr")
install.packages("tidyverse")
install.packages('directlabel')
install.packages('printr')
install.packages('kableExtra')
install.packages('psych', 'here')
install.packages(c('psych', 'here'))
# R Markdown
library(knitr)
# Projects
library(here)
# Statistics
library(psych)
# Tidyverse
library(readxl)
library(tidyverse)
library(broom)
library(glue)
tbl.2 <- read_excel(here('data', 'sde.xlsx'))
tbl.2[1:10, ] %>%
kable
describe(tbl.2)[c('n', 'mean', 'sd', 'min', 'max')] %>%
kable
View(tbl.2)
tbl.2 %>%
lm( A0 ~ PSDE1, .) %>%
tidy
tbl.2 %>%
lm( A0 ~ PSDE2, .) %>%
tidy
tbl.2 %>%
lm( A0 ~ PSDE3, .) %>%
tidy
tbl.2 %>%
lm( A0 ~ PSDE4, .) %>%
tidy
tbl.2 %>%
lm( A0 ~ PSDE3, .) %>%
tidy
tbl.2 %>%
lm( A0 ~ PSDE1, .) %>%
tidy
tbl.2 %>%
lm( A0 ~ PSDE1, .) %>%
tidy
tbl.2 %>%
lm(A1 ~ PSDE1, .) %>%
tidy
tbl.2 %>%
lm(A0 ~ GENDER, .) %>%
tidy
tbl.2 %>%
lm(A1 ~ GENDER, .) %>%
tidy
tbl.2 %>%
lm(A0 ~ GENDER, .) %>%
tidy
tbl.2 %>%
lm(A1 ~ GENDER, .) %>%
summary
tbl.2 %>%
lm(A0 ~ GENDER, .) %>%
summary
tbl.2 %>%
lm(A1 ~ GENDER, .) %>%
summary
tbl.2 %>%
lm(A0 ~ GENDER, .) %>%
tidy
tbl.2 %>%
lm(A1 ~ GENDER, .) %>%
tidy
install.packages("rbbt")
library(remotes)
install.packages("remotes")
remotes::install_github("paleolimbot/rbbt")
remotes::install_github("paleolimbot/rbbt")
install.packages("remotes")
remotes::install_github("paleolimbot/rbbt")
remotes::install_github("paleolimbot/rbbt")
bbt_write_bib("biblio.json", bbt_detect_citation("hw8.Rmd"))
library(rbbt)
bbt_write_bib("biblio.json", bbt_detect_citation("hw8.Rmd"))
?rbbt
?bbt_write_bib
?bbt_detect_citations
bbt_write_bib("biblio.json", bbt_detect_citations("hw8.Rmd"))
cd ..
bbt_write_bib("biblio.json", bbt_detect_citations("hw8.Rmd"))
getwd()
?setwd
setwd("~/1. Projects/Graduate/BUSI 809/809site/hw")
bbt_write_bib("biblio.json", bbt_detect_citations("hw8.Rmd"))
bbt_write_bib("biblio.json", bbt_detect_citations("hw8.Rmd"), overwrite = TRUE)
bbt_write_bib("biblio.json", bbt_detect_citations("hw8.Rmd"), overwrite = TRUE)
bbt_write_bib("biblio.json", bbt_detect_citations("hw8.Rmd"), overwrite = TRUE)
fit.2.3 %>%
summary
# Projects
library(here)
# R Markdown
library(knitr)
# Statistics
library(psych)
# Tidyverse
library(readxl)
library(tidyverse)
library(broom)
library(glue)
fit.2.3 %>%
summary
fit.2.3 <- lm(tp ~ amb + cd, tbl.2)
tbl.2 <- read_excel(here('data', 'AMBSTD.xlsx'))
tbl.2[1:10, ] %>%
kable
describe(tbl.2)[c('n', 'mean', 'sd', 'min', 'max')] %>%
kable
e1 <- mean(tbl.2$amb)
e1
fit.2.2 <- lm(cd ~ amb, tbl.2)
fit.2.2 %>%
tidy %>%
kable
p21 <- coef(fit.2.2)["amb"]
e2 <- sqrt(1 - p21^2)
e2
fit.2.3 <- lm(tp ~ amb + cd, tbl.2)
p31 <- coef(fit.2.3)["amb"]
p32 <- coef(fit.2.3)["cd"]
fit.2.3 %>%
tidy %>%
kable
fit.2.3 %>%
summary
?r.squared
?r_squared
fit.2.3 %>%
summary(.)$r.squared
summary(fit.2.3)$r.squared
e3 <- summary(fit.2.3)$r.squared %>%
sqrt(1 - .^2)
R23 <- summary(fit.2.3)$r.squared
e3 <- sqrt(1 - R23)
e3
R23 <- summary(fit.2.3)$r.squared
e3 <- sqrt(1 - R23)
e3
r13 <- p31 + p21 * p32
r13
r14 <- p21 * p42 + p31 * p43 + p21 * p32 * p43
fit.2.4 <- lm(hi ~ cd + tp, tbl.2)
p42 <- coef(fit.2.4)["cd"]
p43 <- coef(fit.2.4)["tp"]
e4 <- sqrt(1 - summary(fit.2.4)$r.squared)
fit.2.5 <- lm(anx ~ tp + hi, tbl.2)
p53 <- coef(fit.2.5)["tp"]
p54 <- coef(fit.2.5)["hi"]
e5 <- sqrt(1 - summary(fit.2.5)$r.squared)
tibble(p42, p43, e4, p53, p54, e5) %>%
kable
r14 <- p21 * p42 + p31 * p43 + p21 * p32 * p43
r14
#r14 <- p21 * p42 + p31 * p43 + p21 * p32 * p43
r12 * p42 + r13 * p43
r12 <- p21
r12
r13 <- p31 + p21 * p32
r13
r23 <- p32 + p21 * p31
r23
#r14 <- p21 * p42 + p31 * p43 + p21 * p32 * p43
r12 * p42 + r13 * p43
r14
r23 <- p32 + r12 * p31
r23
install.packages("glue")
install.packages(c("fs", "glue", "rlang", "xfun"))
library(glue)
detach("package:glue", unload = TRUE)
remove.packages("glue", lib="~/R/win-library/4.0")
remove.packages("rlang", lib="~/R/win-library/4.0")
remove.packages("xfun", lib="~/R/win-library/4.0")
install.packages(c("glue", "rlang", "xfun"))
install.packages(c("glue", "rlang", "xfun"))
install.packages(c("fs", "glue", "rlang", "xfun"))
library(rbbt)
bbt_write_bib('biblio.json')
bbt_write_bib('biblio.json', overwrite = TRUE)
install.packages("ps")
bbt_write_bib('biblio.json', overwrite = TRUE)
?bbt_write_bib
bbt_write_bib("biblio.json", c("pedhazur82", "specht75"), overwrite = TRUE)
bbt_write_bib("biblio.json", c("pedhazur82", "specht75"), overwrite = TRUE)
# Projects
library(here)
# R Markdown
library(knitr)
# Statistics
library(psych)
# Tidyverse
library(readxl)
library(tidyverse)
library(broom)
library(glue)
library(corrr)
tbl.2 <- read_excel(here('data', 'AMBSTD.xlsx'))
tbl.2[1:10, ] %>%
kable
describe(tbl.2)[c('n', 'mean', 'sd', 'min', 'max')] %>%
kable
e1 <- mean(tbl.2$amb)
e1
fit.2.2 <- lm(cd ~ amb, tbl.2)
fit.2.2 %>%
tidy %>%
kable
p21 <- coef(fit.2.2)["amb"]
e2 <- sqrt(1 - p21^2)
e2
fit.2.3 <- lm(tp ~ amb + cd, tbl.2)
p31 <- coef(fit.2.3)["amb"]
p32 <- coef(fit.2.3)["cd"]
fit.2.3 %>%
tidy %>%
kable
R23 <- summary(fit.2.3)$r.squared
e3 <- sqrt(1 - R23)
e3
fit.2.4 <- lm(hi ~ cd + tp, tbl.2)
p42 <- coef(fit.2.4)["cd"]
p43 <- coef(fit.2.4)["tp"]
e4 <- sqrt(1 - summary(fit.2.4)$r.squared)
fit.2.5 <- lm(anx ~ tp + hi, tbl.2)
p53 <- coef(fit.2.5)["tp"]
p54 <- coef(fit.2.5)["hi"]
e5 <- sqrt(1 - summary(fit.2.5)$r.squared)
tibble(p42, p43, e4, p53, p54, e5) %>%
kable
DE.12 <- p21
r12 <- DE.12
DE.13 <- p31
IE.13 <- p21 * p32
r13 <- DE.13 + IE.13
DE.23 <- p32
S.23 <- p21 * p31
r23 <- DE.23 + S.23
IE.14 <- p21 * p42 + p31 * p43 + p21 * p32 * p43
r14 <- IE.14
DE.24 <- p42
IE.24 <- p32 * p43
S.24 <- p21 * p31 * p43
r24 <- DE.24 + IE.24 + S.24
DE.34 <- p43
S.34 <- r23 * p42
r34 <- DE.34 + S.34
IE.15 <- p31 * p53 + p21 * p42 * p53 + p31 * p43 * p53 + p21 * p32 * p53 + p21 * p32 * p43 * p54
r15 <- IE.15
IE.25 <- p32 * p53 + p42 * p54 + p32 * p43 * p54
S.25 <- p21 * p31 * p53 + p21 * p31 * p43 * p54
r25 <- IE.25 + S.25
DE.35 <- p53
IE.35 <- p43 * p54
S.35 <- r23 * p42 * p54
r35 <- DE.35 + IE.35 + S.35
DE.45 <- p54
S.45 <- r34 * p53
r45 <- DE.45 + S.45
tbl.2.b <- tibble(Vars = c("AMB, CD",
"AMB, TP", "CD, TP",
"AMB, HI", "CD, HI", "TP, HI",
"AMB, ANX", "CD, ANX", "TP, ANX", "HI, ANX"),
r = c(r12, r13, r23, r14, r24, r34, r15, r25, r35, r45),
DE = c(DE.12, DE.13, DE.23, NA, DE.24, DE.34, NA, NA, DE.35, DE.45),
IE = c(NA, IE.13, NA, IE.14, IE.24, NA, IE.15, IE.25, IE.35, NA),
S = c(NA, NA, S.23, NA, S.24, S.34, NA, S.25, S.35, S.45),
U = c(rep(NA,10)))
tbl.2.b %>% kable
N <- nrow(tbl.2)
d <- 3
# Note: Using for loops in R is discouraged, but it's not a big deal for a short vector,
# and using nested map() functions is annoying.
num.2.c <- c()
for (col in select(correlate(tbl.2), -c(1, 2))) {
for (r in col) {
if (!is.na(r)) {
num.2.c <- c(num.2.c, r)
} else {
break
}
}
}
R2m <- 1 - prod(map_dbl(num.2.c, ~ 1 - . ^ 2))
M <- 1 - prod(map_dbl(tbl.2.b$r, ~ 1 - . ^ 2))
W <- -(N - d) * log((1 - R2m) / (1 - M))
p <- dchisq(W, d)
tibble(W = W, p = p) %>%
kable
tibble(tbl.2.b$)
tbl.2.b
tbl.2.b %>%
select(c(1,2))
?mutate
tbl.2.b %>%
select(c(1,2)) %>%
mutate(Observed = num.2.c)
tbl.2.b %>%
select(c(1,2)) %>%
mutate(Observed = num.2.c, .after = Vars)
tbl.2.b %>%
select(c(1,2)) %>%
rename(r = Reproduced) %>%
mutate(Observed = num.2.c, .after = Vars) %>%
mutate(Difference = Observed - Reproduced)
tbl.2.b %>%
select(c(1,2)) %>%
rename(Reproduced = r) %>%
mutate(Observed = num.2.c, .after = Vars) %>%
mutate(Difference = Observed - Reproduced)
tbl.2.b %>%
select(c(1,2)) %>%
rename(Reproduced = r) %>%
mutate(Observed = num.2.c, .after = Vars) %>%
mutate(Difference = Observed - Reproduced) %>%
kable
tbl.2.b %>%
select(c(1,2)) %>%
rename(Reproduced = r) %>%
mutate(Observed = num.2.c, .after = Vars) %>%
mutate(Difference = Observed - Reproduced)
# Projects
library(here)
# R Markdown
library(knitr)
# Statistics
library(psych)
# Tidyverse
library(readxl)
library(tidyverse)
library(broom)
library(glue)
library(corrr)
tbl.2 <- read_excel(here('data', 'AMBSTD.xlsx'))
tbl.2[1:10, ] %>%
kable
describe(tbl.2)[c('n', 'mean', 'sd', 'min', 'max')] %>%
kable
e1 <- mean(tbl.2$amb)
e1
fit.2.2 <- lm(cd ~ amb, tbl.2)
fit.2.2 %>%
tidy %>%
kable
p21 <- coef(fit.2.2)["amb"]
e2 <- sqrt(1 - p21^2)
e2
fit.2.3 <- lm(tp ~ amb + cd, tbl.2)
p31 <- coef(fit.2.3)["amb"]
p32 <- coef(fit.2.3)["cd"]
fit.2.3 %>%
tidy %>%
kable
R23 <- summary(fit.2.3)$r.squared
e3 <- sqrt(1 - R23)
e3
fit.2.4 <- lm(hi ~ cd + tp, tbl.2)
p42 <- coef(fit.2.4)["cd"]
p43 <- coef(fit.2.4)["tp"]
e4 <- sqrt(1 - summary(fit.2.4)$r.squared)
fit.2.5 <- lm(anx ~ tp + hi, tbl.2)
p53 <- coef(fit.2.5)["tp"]
p54 <- coef(fit.2.5)["hi"]
e5 <- sqrt(1 - summary(fit.2.5)$r.squared)
tibble(p42, p43, e4, p53, p54, e5) %>%
kable
DE.12 <- p21
r12 <- DE.12
DE.13 <- p31
IE.13 <- p21 * p32
r13 <- DE.13 + IE.13
DE.23 <- p32
S.23 <- p21 * p31
r23 <- DE.23 + S.23
IE.14 <- p21 * p42 + p31 * p43 + p21 * p32 * p43
r14 <- IE.14
DE.24 <- p42
IE.24 <- p32 * p43
S.24 <- p21 * p31 * p43
r24 <- DE.24 + IE.24 + S.24
DE.34 <- p43
S.34 <- r23 * p42
r34 <- DE.34 + S.34
IE.15 <- p31 * p53 + p21 * p42 * p53 + p31 * p43 * p53 + p21 * p32 * p53 + p21 * p32 * p43 * p54
r15 <- IE.15
IE.25 <- p32 * p53 + p42 * p54 + p32 * p43 * p54
S.25 <- p21 * p31 * p53 + p21 * p31 * p43 * p54
r25 <- IE.25 + S.25
DE.35 <- p53
IE.35 <- p43 * p54
S.35 <- r23 * p42 * p54
r35 <- DE.35 + IE.35 + S.35
DE.45 <- p54
S.45 <- r34 * p53
r45 <- DE.45 + S.45
tbl.2.b <- tibble(Vars = c("AMB, CD",
"AMB, TP", "CD, TP",
"AMB, HI", "CD, HI", "TP, HI",
"AMB, ANX", "CD, ANX", "TP, ANX", "HI, ANX"),
r = c(r12, r13, r23, r14, r24, r34, r15, r25, r35, r45),
DE = c(DE.12, DE.13, DE.23, NA, DE.24, DE.34, NA, NA, DE.35, DE.45),
IE = c(NA, IE.13, NA, IE.14, IE.24, NA, IE.15, IE.25, IE.35, NA),
S = c(NA, NA, S.23, NA, S.24, S.34, NA, S.25, S.35, S.45),
U = c(rep(NA,10)))
tbl.2.b %>% kable
N <- nrow(tbl.2)
d <- 3
# Note: Using for loops in R is discouraged, but it's not a big deal for a short vector,
# and using nested map() functions is annoying.
num.2.c <- c()
for (col in select(correlate(tbl.2), -c(1, 2))) {
for (r in col) {
if (!is.na(r)) {
num.2.c <- c(num.2.c, r)
} else {
break
}
}
}
R2m <- 1 - prod(map_dbl(num.2.c, ~ 1 - . ^ 2))
M <- 1 - prod(map_dbl(tbl.2.b$r, ~ 1 - . ^ 2))
W <- -(N - d) * log((1 - R2m) / (1 - M))
p <- dchisq(W, d)
tibble(W = W, p = p) %>%
kable
tbl.2.b %>%
select(c(1,2)) %>%
rename(Reproduced = r) %>%
mutate(Observed = num.2.c, .after = Vars) %>%
mutate(Difference = Observed - Reproduced) %>%
kable
fisherz()
tbl.2.c <- tbl.2.b %>%
select(c(1,2)) %>%
rename(Reproduced = r) %>%
mutate(Observed = num.2.c, .after = Vars) %>%
mutate(Difference = Observed - Reproduced)
tbl.2.c %>%
kable
tbl.2.c %>%
filter(Vars == "AMB, HI")
tbl.2.c %>%
mutate(Obs.z = fisherz(Observed),
Rep.z = fisherz(Reproduced))
tbl.2.c %>%
select(- "Difference") %>%
mutate(Obs.z = fisherz(Observed),
Rep.z = fisherz(Reproduced))
tbl.2.c %>%
select(- "Difference") %>%
transmute(Obs.z = fisherz(Observed),
Rep.z = fisherz(Reproduced))
tbl.2.c %>%
select(- "Difference") %>%
transmute(Vars = Vars,
Obs.z = fisherz(Observed),
Rep.z = fisherz(Reproduced))
tbl.2.c %>%
select(- "Difference") %>%
transmute(Vars = Vars,
Obs.z = fisherz(Observed),
Rep.z = fisherz(Reproduced),
p = dnorm(Obs.z - Rep.z))
tbl.2.c %>%
select(- "Difference") %>%
mutate(z = paired.r(Observed, Reproduced))
tbl.2.c %>%
select(- "Difference") %>%
mutate(z = paired.r(Observed, Reproduced, nrow(tbl.2)))
tbl.2.c %>%
select(- "Difference") %>%
mutate(z = paired.r(Observed, Reproduced, n = nrow(tbl.2)))
tbl.2.c %>%
select(- "Difference") %>%
mutate(z = paired.r(Observed, Reproduced, n = nrow(tbl.2)$z))
paired.r(.1, .2, 211)
paired.r(.1, .2, n = 211)
paired.r(.1, .2, n = 211) %>% attributes
paired.r(.1, .2, n = 211)$z
paired.r(.1, .2, n = 211)$p
tbl.2.c %>%
select(- "Difference") %>%
mutate(z = paired.r(Observed, Reproduced, n = nrow(tbl.2))$z)
tbl.2.c %>%
select(- "Difference") %>%
mutate(z = paired.r(Observed, Reproduced, n = nrow(tbl.2))$z,
p = paired.r(Observed, Reproduced, n = nrow(tbl.2))$z)
tbl.2.c %>%
select(- "Difference") %>%
mutate(z = paired.r(Observed, Reproduced, n = nrow(tbl.2))$z,
p = paired.r(Observed, Reproduced, n = nrow(tbl.2))$z)
